
Efficient and accurate malicious traffic detection is crucial for defending high-throughput networks against evolving cyber threats. However, current approaches face critical limitations. Lightweight intra-flow approaches lack cross-service discrimination, yielding high false negatives as attackers mimic benign traffic. Inter-flow semantic methods boost accuracy but incur prohibitive memory and latency costs from static graph operations, hindering deployment in dynamic environments. To address these challenges, we propose RearView, a two-stage, relationship-aware framework for efficient malicious traffic detection. In the first stage, lightweight service-personalized attention-augmented Variational Autoencoders identify suspicious sessions by effectively disambiguating intra-flow patterns, enabling rapid filtering of benign traffic. The second stage constructs dynamic session graphs and employs an anomaly-weighted GraphSAGE-based Deep Graph Infomax module to model inter-flow relationships, enabling in-depth exploration of cross-session behaviors in suspicious flows. To ensure scalability and low latency, we incorporate a streaming cache mechanism optimized for high-throughput environments. Extensive evaluations on four benchmark datasets and one self-constructed dataset demonstrate that RearView achieves an average F1-score of 97.79%, outperforming state-of-the-art methods by 10.19% on average. RearView also reduces the false positive rate by 4.99% and the false negative rate by 34.44%, with per-flow detection latency under 2 ms, showcasing strong potential for real-world deployment.
